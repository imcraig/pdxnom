<!DOCTYPE html>
<html> 
<head> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
<title>Google Maps Multiple Markers</title> 
  <script src="http://maps.google.com/maps/api/js?sensor=false" 
            type="text/javascript"></script>

<script type="text/javascript" src="./lib/jquery.js">
</script>

</head>
<body>
<div id="map" style="width: 500px; height: 400px;"></div>

<script type="text/javascript">
var cartopia = new google.maps.LatLng(45.512431,-122.65332);  /// 12th and se hawthorne ,"cartopia"
var pod0 = new google.maps.LatLng(45.519934,-122.674499); // 3rd and sw washington
var pod1 = new google.maps.LatLng(45.521143,-122.676215); // 5th and sw stark

var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 13,
    center: cartopia,
    mapTypeId: google.maps.MapTypeId.ROADMAP
});

var infowindow = new google.maps.InfoWindow();
var marker, i;

new google.maps.Marker({
    position: cartopia,
    map     : map
});

$.getJSON("./data/carts.json",
    function(data) {
        console.dir(data);
        $.each(data.markers, function(i,m){
                console.log("adding marker " + m.lat + " " + m.lng + " i= " + i );
                // TODO: lat and long are reversed in data file
                var loc = new google.maps.LatLng(m.lng , m.lat );
                var marker = new google.maps.Marker({
                    position: loc,
                    map     : map
                });
                google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                        infowindow.setContent(m.title);
                        infowindow.open(map, marker);
                    }
                })(marker, i));
        });
    });
</script>
</body>
</html>
